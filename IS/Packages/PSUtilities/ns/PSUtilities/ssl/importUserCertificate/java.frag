<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="name">importUserCertificate</value>
  <array name="sig" type="value" depth="1">
    <value>[i] field:0:required certificatePath</value>
    <value>[i] object:0:required certificate</value>
    <value>[i] field:0:required user</value>
    <value>[o] field:0:required certificateIssuerCN</value>
    <value>[o] field:0:required certificateSubjectCN</value>
    <value>[o] field:0:required certificateSerialNumber</value>
    <value>[o] field:0:required errorMsg</value>
  </array>
  <value name="sigtype">java 3.5</value>
  <value name="encodeutf8">true</value>
  <value name="body">DQpTdHJpbmcgY2VydGlmaWNhdGVQYXRoID0gbnVsbDsNClN0cmluZyB1c2VyID0gbnVsbDsNCg0K
U3RyaW5nIGNlcnRpZmljYXRlSXNzdWVyID0gbnVsbDsNCjsNClN0cmluZyBjZXJ0aWZpY2F0ZVNl
cmlhbE51bWJlciA9IG51bGw7DQpTdHJpbmcgY2VydGlmaWNhdGVTdWJqZWN0ID0gbnVsbDsNCmJ5
dGVbXSBjZXJ0aWZpY2F0ZSA9IG51bGw7DQppYWlrLng1MDkuWDUwOUNlcnRpZmljYXRlIHg1MDlj
ZXJ0aWZpY2F0ZSA9IG51bGw7DQoNCi8vIHBpcGVsaW5lDQpJRGF0YUN1cnNvciBwaXBlbGluZUN1
cnNvciA9IHBpcGVsaW5lLmdldEN1cnNvcigpOw0KaWYgKHBpcGVsaW5lQ3Vyc29yLmZpcnN0KCJj
ZXJ0aWZpY2F0ZVBhdGgiKSkNCnsNCiAgY2VydGlmaWNhdGVQYXRoID0gKFN0cmluZykgcGlwZWxp
bmVDdXJzb3IuZ2V0VmFsdWUoKTsNCn0NCmlmIChwaXBlbGluZUN1cnNvci5maXJzdCgiY2VydGlm
aWNhdGUiKSkNCnsNCiAgY2VydGlmaWNhdGUgPSAoYnl0ZVtdKSBwaXBlbGluZUN1cnNvci5nZXRW
YWx1ZSgpOw0KfQ0KDQppZiAocGlwZWxpbmVDdXJzb3IuZmlyc3QoInVzZXIiKSkNCnsNCiAgdXNl
ciA9IChTdHJpbmcpIHBpcGVsaW5lQ3Vyc29yLmdldFZhbHVlKCk7DQp9DQoNCi8vIHBpcGVsaW5l
DQppZiAodXNlciA9PSBudWxsKQ0Kew0KICBwaXBlbGluZUN1cnNvci5pbnNlcnRBZnRlcigiZXJy
b3JNc2ciLCAibnVsbCBpbnB1dCB1c2VyLiIpOw0KICByZXR1cm47DQp9DQoNCmlmIChjZXJ0aWZp
Y2F0ZVBhdGggPT0gbnVsbCAmJiBjZXJ0aWZpY2F0ZSA9PSBudWxsKQ0Kew0KICBwaXBlbGluZUN1
cnNvci5pbnNlcnRBZnRlcigiZXJyb3JNc2ciLCAiRWl0aGVyIGNlcnRpZmljYXRlUGF0aCBhbmQg
Y2VydGlmaWNhdGUgY2FuIG5vdCBiZSBudWxsLiIpOw0KICByZXR1cm47DQp9DQoNCmlmICh1c2Vy
LmVxdWFscygiQWRtaW5pc3RyYXRvciIpKQ0Kew0KICBwaXBlbGluZUN1cnNvci5pbnNlcnRBZnRl
cigiZXJyb3JNc2ciLCAiSW1wb3J0IGRlbmllZDogQ2Fubm90IG1hcCB0byBBZG1pbmlzdHJhdG9y
LiIpOw0KICByZXR1cm47DQp9DQoNCnRyeQ0Kew0KICBpZiAoY2VydGlmaWNhdGVQYXRoICE9IG51
bGwpDQogIHsNCiAgICBqYXZhLmlvLkZpbGUgZmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUoY2VydGlm
aWNhdGVQYXRoKTsNCiAgICBpZiAoIWZpbGUuZXhpc3RzKCkpDQogICAgew0KICAgICAgcGlwZWxp
bmVDdXJzb3IuaW5zZXJ0QWZ0ZXIoImVycm9yTXNnIiwgImNlcnRpZmljYXRlIGRvZXNuJ3QgZXhp
c3QuIik7DQogICAgICByZXR1cm47DQogICAgfQ0KDQogICAgaWYgKGZpbGUubGVuZ3RoKCkgPT0g
MEwpDQogICAgew0KICAgICAgcGlwZWxpbmVDdXJzb3IuaW5zZXJ0QWZ0ZXIoImVycm9yTXNnIiwg
ImNlcnRpZmljYXRlIGlzIGVtcHR5LiIpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIC8v
IGNyZWF0ZSBjZXJ0aWZpY2F0ZQ0KICAgIGphdmEuaW8uRmlsZUlucHV0U3RyZWFtIGZpbGVpbnB1
dHN0cmVhbSA9IG5ldyBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbShmaWxlKTsNCiAgICB4NTA5Y2Vy
dGlmaWNhdGUgPSBuZXcgaWFpay54NTA5Llg1MDlDZXJ0aWZpY2F0ZShmaWxlaW5wdXRzdHJlYW0p
Ow0KICAgIGZpbGVpbnB1dHN0cmVhbS5jbG9zZSgpOw0KICB9DQogIGVsc2UgaWYgKGNlcnRpZmlj
YXRlICE9IG51bGwpDQogIHsNCiAgICB4NTA5Y2VydGlmaWNhdGUgPSBuZXcgaWFpay54NTA5Llg1
MDlDZXJ0aWZpY2F0ZShjZXJ0aWZpY2F0ZSk7DQogIH0NCg0KICAvLyBjaGVjayBpZiBjZXJ0aWZp
Y2F0ZSBleGlzdHMNCiAgU3RyaW5nIGlzc3VlciA9IHg1MDljZXJ0aWZpY2F0ZS5nZXRJc3N1ZXJE
TigpLnRvU3RyaW5nKCk7DQogIFN0cmluZyBzZXJpYWxOdW1iZXIgPSB4NTA5Y2VydGlmaWNhdGUu
Z2V0U2VyaWFsTnVtYmVyKCkudG9TdHJpbmcoKTsNCiAgY2VydGlmaWNhdGVJc3N1ZXIgPSBpc3N1
ZXI7DQogIDsNCiAgY2VydGlmaWNhdGVTZXJpYWxOdW1iZXIgPSBzZXJpYWxOdW1iZXI7DQogIGNl
cnRpZmljYXRlU3ViamVjdCA9IHg1MDljZXJ0aWZpY2F0ZS5nZXRTdWJqZWN0RE4oKS50b1N0cmlu
ZygpOw0KDQogIGNvbS53bS5hcHAuYjJiLnNlcnZlci5DZXJ0aWZpY2F0ZU1hcEVudHJ5IGFjZXJ0
aWZpY2F0ZW1hcGVudHJ5W10gPSBjb20ud20uYXBwLmIyYi5zZXJ2ZXIuQ2VydGlmaWNhdGVNYXBw
ZXIuY3VycmVudCgpLmxpc3RNYXBwaW5ncygpOw0KICBpZiAoYWNlcnRpZmljYXRlbWFwZW50cnkg
IT0gbnVsbCAmJiBhY2VydGlmaWNhdGVtYXBlbnRyeS5sZW5ndGggIT0gMCkNCiAgew0KICAgIGZv
ciAoaW50IGkgPSAwOyBpIDwgYWNlcnRpZmljYXRlbWFwZW50cnkubGVuZ3RoOyBpKyspDQogICAg
ew0KICAgICAgamF2YS5zZWN1cml0eS5jZXJ0Llg1MDlDZXJ0aWZpY2F0ZSBhWDUwOWNlcnRpZmlj
YXRlID0gYWNlcnRpZmljYXRlbWFwZW50cnlbaV0uZ2V0Q2VydGlmaWNhdGUoKTsNCiAgICAgIGlm
IChzZXJpYWxOdW1iZXIuZXF1YWxzKGFYNTA5Y2VydGlmaWNhdGUuZ2V0U2VyaWFsTnVtYmVyKCku
dG9TdHJpbmcoKSkgJiYgaXNzdWVyLmVxdWFscyhhWDUwOWNlcnRpZmljYXRlLmdldElzc3VlckRO
KCkudG9TdHJpbmcoKSkpDQogICAgICB7DQogICAgICAgIHBpcGVsaW5lQ3Vyc29yLmluc2VydEFm
dGVyKCJlcnJvck1zZyIsICJjZXJ0aWZpY2F0ZSBhbHJlYWR5IGV4aXN0cy4iKTsNCiAgICAgICAg
cmV0dXJuOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC8vIGFkZCBjZXJ0aWZpY2F0ZSB0byB0
aGUgbWFwcGluZyBsaXN0DQogIGNvbS53bS5hcHAuYjJiLnNlcnZlci5Vc2VyIHNlcnZlclVzZXIg
PSBjb20ud20uYXBwLmIyYi5zZXJ2ZXIuVXNlck1hbmFnZXIuZ2V0VXNlcih1c2VyKTsNCiAgaWYg
KCFjb20ud20uYXBwLmIyYi5zZXJ2ZXIuQ2VydGlmaWNhdGVNYXBwZXIuY3VycmVudCgpLmFkZE1h
cHBpbmcoc2VydmVyVXNlciwgeDUwOWNlcnRpZmljYXRlKSkNCiAgew0KICAgIHBpcGVsaW5lQ3Vy
c29yLmluc2VydEFmdGVyKCJlcnJvck1zZyIsICJlcnJvciBpbiBpbXBvcnRpbmcgY2VydGlmaWNh
dGUgYXMgIiArIHVzZXIpOw0KICAgIHJldHVybjsNCiAgfQ0KfQ0KY2F0Y2ggKEV4Y2VwdGlvbiBl
KQ0Kew0KICBwaXBlbGluZUN1cnNvci5pbnNlcnRBZnRlcigiZXJyb3JNc2ciLCBlLnRvU3RyaW5n
KCkpOw0KICByZXR1cm47DQp9DQoNCmludCBzdGFydEluZGV4ID0gY2VydGlmaWNhdGVJc3N1ZXIu
aW5kZXhPZigiQ049Iik7DQppbnQgZW5kSW5kZXggPSBjZXJ0aWZpY2F0ZUlzc3Vlci5pbmRleE9m
KCIsIiwgc3RhcnRJbmRleCk7DQpjZXJ0aWZpY2F0ZUlzc3VlciA9IGNlcnRpZmljYXRlSXNzdWVy
LnN1YnN0cmluZyhzdGFydEluZGV4ICsgMywgZW5kSW5kZXgpOw0KDQpzdGFydEluZGV4ID0gY2Vy
dGlmaWNhdGVTdWJqZWN0LmluZGV4T2YoIkNOPSIpOw0KZW5kSW5kZXggPSBjZXJ0aWZpY2F0ZVN1
YmplY3QuaW5kZXhPZigiLCIsIHN0YXJ0SW5kZXgpOw0KY2VydGlmaWNhdGVTdWJqZWN0ID0gY2Vy
dGlmaWNhdGVTdWJqZWN0LnN1YnN0cmluZyhzdGFydEluZGV4ICsgMywgZW5kSW5kZXgpOw0KDQov
LyBwaXBlbGluZQ0KcGlwZWxpbmVDdXJzb3IgPSBwaXBlbGluZS5nZXRDdXJzb3IoKTsNCnBpcGVs
aW5lQ3Vyc29yLmxhc3QoKTsNCnBpcGVsaW5lQ3Vyc29yLmluc2VydEFmdGVyKCJjZXJ0aWZpY2F0
ZUlzc3VlckNOIiwgY2VydGlmaWNhdGVJc3N1ZXIpOw0KcGlwZWxpbmVDdXJzb3IubGFzdCgpOw0K
cGlwZWxpbmVDdXJzb3IuaW5zZXJ0QWZ0ZXIoImNlcnRpZmljYXRlU3ViamVjdENOIiwgY2VydGlm
aWNhdGVTdWJqZWN0KTsNCnBpcGVsaW5lQ3Vyc29yLmxhc3QoKTsNCnBpcGVsaW5lQ3Vyc29yLmlu
c2VydEFmdGVyKCJjZXJ0aWZpY2F0ZVNlcmlhbE51bWJlciIsIGNlcnRpZmljYXRlU2VyaWFsTnVt
YmVyKTsNCnBpcGVsaW5lQ3Vyc29yLmRlc3Ryb3koKTsNCg==</value>
</Values>
